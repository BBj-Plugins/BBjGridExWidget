"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[9566],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>p});var i=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t){if(null==e)return{};var n,i,o=function(e,t){if(null==e)return{};var n,i,o={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=i.createContext({}),u=function(e){var t=i.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},d=function(e){var t=u(e.components);return i.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},m=i.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,s=e.parentName,d=a(e,["components","mdxType","originalType","parentName"]),m=u(n),p=o,h=m["".concat(s,".").concat(p)]||m[p]||c[p]||r;return n?i.createElement(h,l(l({ref:t},d),{},{components:n})):i.createElement(h,l({ref:t},d))}));function p(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,l=new Array(r);l[0]=m;var a={};for(var s in t)hasOwnProperty.call(t,s)&&(a[s]=t[s]);a.originalType=e,a.mdxType="string"==typeof e?e:o,l[1]=a;for(var u=2;u<r;u++)l[u]=n[u];return i.createElement.apply(null,l)}return i.createElement.apply(null,n)}m.displayName="MDXCreateElement"},1374:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>c,frontMatter:()=>r,metadata:()=>a,toc:()=>u});var i=n(7462),o=(n(7294),n(3905));const r={sidebar_position:3,title:"Columns Sizing"},l=void 0,a={unversionedId:"columns/columns-sizing",id:"columns/columns-sizing",title:"Columns Sizing",description:"All columns can be resized by dragging the top right portion of the column.",source:"@site/docs/columns/columns-sizing.md",sourceDirName:"columns",slug:"/columns/columns-sizing",permalink:"/BBjGridExWidget/docs/columns/columns-sizing",draft:!1,editUrl:"https://github.com/BBj-Plugins/BBjGridExWidget/tree/dev/website/docs/columns/columns-sizing.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3,title:"Columns Sizing"},sidebar:"tutorialSidebar",previous:{title:"Columns Group",permalink:"/BBjGridExWidget/docs/columns/columns-groups"},next:{title:"Columns Moving",permalink:"/BBjGridExWidget/docs/columns/columns-moving"}},s={},u=[{value:"Enable Sizing",id:"enable-sizing",level:2},{value:"Size Columns to Fit",id:"size-columns-to-fit",level:2},{value:"Auto-Size Columns",id:"auto-size-columns",level:2},{value:"Auto-Size Columns Programmatically",id:"auto-size-columns-programmatically",level:3},{value:"Auto-Size a subset of columns",id:"auto-size-a-subset-of-columns",level:3}],d={toc:u};function c(e){let{components:t,...n}=e;return(0,o.kt)("wrapper",(0,i.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"All columns can be resized by dragging the top right portion of the column."),(0,o.kt)("h2",{id:"enable-sizing"},"Enable Sizing"),(0,o.kt)("p",null,"Turn column resizing on/off for the grid by setting ",(0,o.kt)("inlineCode",{parentName:"p"},"resizable=true")," for each column. To set resizing for each column, set ",(0,o.kt)("inlineCode",{parentName:"p"},"resizable=true")," on ",(0,o.kt)("a",{parentName:"p",href:"../api/columns-interface#avoid-duplication-of-column-definitions"},"the default column definition.")),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"By default the grid enable columns resizing for all columns")),(0,o.kt)("h2",{id:"size-columns-to-fit"},"Size Columns to Fit"),(0,o.kt)("p",null,"Call ",(0,o.kt)("inlineCode",{parentName:"p"},"BBjGridExWidget.sizeColumnsToFit()")," to make the currently visible columns fit the screen. The columns will scale (growing or shrinking) to fit the available width."),(0,o.kt)("p",null,"If you don't want a particular column to be included in the auto resize, then set the column option ",(0,o.kt)("inlineCode",{parentName:"p"},"SuppressSizeToFit=true"),". This is helpful if, for example, you want the first column to remain fixed with, but all other columns to fill the width of the table."),(0,o.kt)("h2",{id:"auto-size-columns"},"Auto-Size Columns"),(0,o.kt)("p",null,"Just like Excel, each column can be 'auto resized' by double clicking the right side of the header rather than dragging it. When you do this, the grid will work out the best width to fit the contents of the cells in the column."),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"The grid works out the best width by considering the virtually rendered rows only. For example, if your grid has 10,000 rows, but only 50 rendered due to virtualisation of rows, then only these 50 will be considered for working out the width to display. The rendered rows are all the rows you can see on the screen through the horizontal scroll plus a small buffer (default buffer size is 20).")),(0,o.kt)("h3",{id:"auto-size-columns-programmatically"},"Auto-Size Columns Programmatically"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"BBjGridExWidget.autoSizeColumns")," looks at the rendered cells on the screen, and works out the width based on what it sees. It cannot see the columns that are not rendered due to column virtualisation. Thus it is not possible to autosize a column that is not visible on the screen."),(0,o.kt)("admonition",{type:"tip"},(0,o.kt)("p",{parentName:"admonition"},(0,o.kt)("strong",{parentName:"p"},"Column Virtualisation")," is the technique the grid uses to render large amounts of columns with degrading performance by only rendering columns that are visible due to the horizontal scroll positions. Eg the grid can have 1000 columns with only 10 rendered if the horizontal scroll is only showing 10 columns.")),(0,o.kt)("p",null,"To get around this, you can turn off column virtualisation by setting grid option ",(0,o.kt)("inlineCode",{parentName:"p"},"SuppressColumnVirtualisation=true"),". So choice is yours - what do you want - column virtualisation working OR auto-size working on off screen columns."),(0,o.kt)("p",null,"It's important to point out that ",(0,o.kt)("inlineCode",{parentName:"p"},"BBjGridExWidget.autoSizeColumns(BBjNumber skipHeaders!)")," can receive true as parameter to indicate that the header content should not be considered when calculating the width of the column. You can also set this behavior to be the default by setting the grid option ",(0,o.kt)("inlineCode",{parentName:"p"},"SkipHeaderOnAutoSize: true"),"."),(0,o.kt)("h3",{id:"auto-size-a-subset-of-columns"},"Auto-Size a subset of columns"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"BBjGridExWidget.autoSizeColumns")," has other ",(0,o.kt)("a",{parentName:"p",href:"https://bbj-plugins.github.io/BBjGridExWidget/javadoc/BBjGridExWidget/BBjGridExWidget.html#autoSizeColumns"},"signatures")," which allows the developer to autosize only a subset of columns:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"void autoSizeColumns(HashSet columns!, BBjNumber skipHeader!)")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"void autoSizeColumns(HashSet columns!)")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"void autoSizeColumns(BBjString columns!, BBjNumber skipHeader!)")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"void autoSizeColumns(BBjString columns!)"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bbj",metastring:"showLineNumbers",showLineNumbers:!0},'use ::BBjGridExWidget/BBjGridExWidget.bbj::BBjGridExWidget\nuse com.basiscomponents.db.ResultSet\nuse com.basiscomponents.bc.SqlQueryBC\n\ndeclare auto BBjTopLevelWindow wnd!\ndeclare BBjGridExWidget grid!\ndeclare SqlQueryBC sbc!\ndeclare ResultSet rs!\n\nwnd! = BBjAPI().openSysGui("X0").addWindow(10,10,820,600,"Columns Sizing Demo")\nwnd!.setCallback(BBjAPI.ON_CLOSE,"byebye")\nwnd!.setCallback(BBjAPI.ON_RESIZE,"resize")\n\nsizeToFit! = wnd!.addButton(200,10,10,150,25,"Size To Fit")\nsizeToFit!.setCallback(BBjAPI.ON_BUTTON_PUSH,"sizeToFit")\n\nautoSizeAll! = wnd!.addButton(201,160,10,150,25,"Auto-size All")\nautoSizeAll!.setCallback(BBjAPI.ON_BUTTON_PUSH,"autoSizeAll")\n\nautoSizeTitle! = wnd!.addButton(202,310,10,200,25,"Auto-size (TITLE)")\nautoSizeTitle!.setCallback(BBjAPI.ON_BUTTON_PUSH,"autoSizeTitle")\n\ngosub main\nprocess_events\n\nmain:\n  sbc! = new SqlQueryBC(BBjAPI().getJDBCConnection("CDStore"))\n  rs! = sbc!.retrieve("SELECT * FROM CDINVENTORY")\n\n  grid! = new BBjGridExWidget(wnd!,100, 0,50,820,550)\n  grid!.setData(rs!)\nreturn\n\nrem Make the currently visible columns fit the screen width\nsizeToFit:\n  grid!.setFitToGrid()\nreturn\n\nrem looks at the rendered cells on the screen, and works out\nrem the width based on what it sees.\nautoSizeAll:\n    grid!.autoSizeColumns()\nreturn\n\nrem looks at the rendered TITLE column on the screen, and works out\nrem the width of the column based on its content\nautoSizeTitle:\n    rem it is not necessary to call setFitToGrid() , we call it here for the demo purpose only\n    grid!.setFitToGrid()\n    grid!.autoSizeColumns("TITLE")\nreturn\n\nrem Listen to the BBjTopLevelWindow resize events and\nrem resize the grid to fill the available space.\nresize:\n  ev! = BBjAPI().getLastEvent()\n  w=ev!.getWidth()\n  h=ev!.getHeight()\n  grid!.setSize(w,h)\nreturn\n\nbyebye:\nbye\n')))}c.isMDXComponent=!0}}]);