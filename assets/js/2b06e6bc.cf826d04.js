"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[3738],{3905:(e,t,n)=>{n.d(t,{Zo:()=>g,kt:()=>c});var i=n(7294);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t){if(null==e)return{};var n,i,l=function(e,t){if(null==e)return{};var n,i,l={},a=Object.keys(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||(l[n]=e[n]);return l}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}var o=i.createContext({}),s=function(e){var t=i.useContext(o),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},g=function(e){var t=s(e.components);return i.createElement(o.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},u=i.forwardRef((function(e,t){var n=e.components,l=e.mdxType,a=e.originalType,o=e.parentName,g=d(e,["components","mdxType","originalType","parentName"]),u=s(n),c=l,h=u["".concat(o,".").concat(c)]||u[c]||p[c]||a;return n?i.createElement(h,r(r({ref:t},g),{},{components:n})):i.createElement(h,r({ref:t},g))}));function c(e,t){var n=arguments,l=t&&t.mdxType;if("string"==typeof e||l){var a=n.length,r=new Array(a);r[0]=u;var d={};for(var o in t)hasOwnProperty.call(t,o)&&(d[o]=t[o]);d.originalType=e,d.mdxType="string"==typeof e?e:l,r[1]=d;for(var s=2;s<a;s++)r[s]=n[s];return i.createElement.apply(null,r)}return i.createElement.apply(null,n)}u.displayName="MDXCreateElement"},3818:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>o,contentTitle:()=>r,default:()=>p,frontMatter:()=>a,metadata:()=>d,toc:()=>s});var i=n(7462),l=(n(7294),n(3905));const a={sidebar_position:2,title:"Start / Stop Cell Editing"},r=void 0,d={unversionedId:"editing/start-stop-cell-editing",id:"editing/start-stop-cell-editing",title:"Start / Stop Cell Editing",description:"This page discusses the different ways in which Cell Editing can be started and stopped.",source:"@site/docs/editing/start-stop-cell-editing.md",sourceDirName:"editing",slug:"/editing/start-stop-cell-editing",permalink:"/BBjGridExWidget/docs/editing/start-stop-cell-editing",draft:!1,editUrl:"https://github.com/BBj-Plugins/BBjGridExWidget/tree/dev/website/docs/editing/start-stop-cell-editing.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2,title:"Start / Stop Cell Editing"},sidebar:"tutorialSidebar",previous:{title:"Overview",permalink:"/BBjGridExWidget/docs/editing/overview"},next:{title:"Value Parsers",permalink:"/BBjGridExWidget/docs/editing/value-parsers"}},o={},s=[{value:"Start Editing",id:"start-editing",level:2},{value:"Stop Editing",id:"stop-editing",level:2},{value:"Tab Navigation",id:"tab-navigation",level:2},{value:"Editing API",id:"editing-api",level:2},{value:"Enter Key Navigation",id:"enter-key-navigation",level:2},{value:"Single-Click Editing",id:"single-click-editing",level:2},{value:"No-Click Editing",id:"no-click-editing",level:2},{value:"Stop Editing When Grid Loses Focus",id:"stop-editing-when-grid-loses-focus",level:2}],g={toc:s};function p(e){let{components:t,...a}=e;return(0,l.kt)("wrapper",(0,i.Z)({},g,a,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"This page discusses the different ways in which Cell Editing can be started and stopped."),(0,l.kt)("h2",{id:"start-editing"},"Start Editing"),(0,l.kt)("p",null,"Assuming ",(0,l.kt)("inlineCode",{parentName:"p"},"Editable=1")," is set on the Column, editing will start upon any of the following:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"Edit Key Pressed"),": One of the following is pressed: ",(0,l.kt)("kbd",null,"Enter"),", ",(0,l.kt)("kbd",null,"F2"),", ",(0,l.kt)("kbd",null,"Backspace"),", ",(0,l.kt)("kbd",null,"Delete"),". If this happens then params.key will contain the key code of the key that started the edit. The default editor will clear the contents of the cell if Backspace or Delete are pressed."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"Printable Key Pressed"),": Any of the following characters are pressed: ",(0,l.kt)("inlineCode",{parentName:"li"},"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890!\"\xa3$%^&amp;*()_+-=[];\\'#,./\\|<>?:@~{}"),"."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"Mouse Double Click"),": If the mouse is double-clicked. There is a grid option ",(0,l.kt)("inlineCode",{parentName:"li"},"SingleClickEdit")," that will allow single-click to start editing instead of double-click. Another option ",(0,l.kt)("inlineCode",{parentName:"li"},"SuppressClickEdit")," will prevent both single-click and double-click from starting the edit; use this if you only want to have your own way of starting editing, such as clicking a button in your custom cell renderer."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"strong"},"BBGridExWidget::setStartCellEditing")),": If you call ",(0,l.kt)("a",{parentName:"li",href:"https://bbj-plugins.github.io/BBjGridExWidget/javadoc/BBjGridExWidget/BBjGridExWidget.html#setStartCellEditing"},(0,l.kt)("inlineCode",{parentName:"a"},"setStartCellEditing"))," on the grid API")),(0,l.kt)("h2",{id:"stop-editing"},"Stop Editing"),(0,l.kt)("p",null,"The grid will stop editing when any of the following happen:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"Other Cell Focus"),": If focus in the grid goes to another cell, the editing will stop."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"Enter Key Down"),": If the grid receives an ",(0,l.kt)("kbd",null,"Enter")," key press event on the cell."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"Escape Key Down"),": Similar to ",(0,l.kt)("kbd",null,"Enter"),", if ",(0,l.kt)("kbd",null,"Esc")," key is pressed, editing will stop. Unlike ",(0,l.kt)("kbd",null,"Enter"),", the ",(0,l.kt)("kbd",null,"Esc")," action will discard changes rather than taking the new value."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"Tab Key Down"),": Editing will stop, accepting changes, and editing will move to the next cell, or the previous cell if ",(0,l.kt)("kbd",null,"Shift")," is also pressed."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"Popup Editor Closed"),": If using popup editor, the popup is configured to close if you click outside the editor. Closing the popup triggers the grid to stop editing."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"strong"},"BBjGridExWidget::stopEditing")),": If you call ",(0,l.kt)("a",{parentName:"li",href:"https://bbj-plugins.github.io/BBjGridExWidget/javadoc/BBjGridExWidget/BBjGridExWidget.html#stopEditing"},(0,l.kt)("inlineCode",{parentName:"a"},"stopEditing"))," on the grid API.")),(0,l.kt)("h2",{id:"tab-navigation"},"Tab Navigation"),(0,l.kt)("p",null,"While editing, if you hit ",(0,l.kt)("kbd",null,"Tab"),", the editing will stop for the current cell and start on the next cell. If you hold down ",(0,l.kt)("kbd",null,"Shift+Tab"),", the same will happen except the previous cell will start editing rather than the next. This is in line with editing data in Excel."),(0,l.kt)("p",null,"The next and previous cells can also be navigated using the API ",(0,l.kt)("a",{parentName:"p",href:"https://bbj-plugins.github.io/BBjGridExWidget/javadoc/BBjGridExWidget/BBjGridExWidget.html#tabToNextCell"},(0,l.kt)("inlineCode",{parentName:"a"},"BBjGridExWidget::tabToNextCell"))," and ",(0,l.kt)("a",{parentName:"p",href:"https://bbj-plugins.github.io/BBjGridExWidget/javadoc/BBjGridExWidget/BBjGridExWidget.html#tabToPreviousCell"},(0,l.kt)("inlineCode",{parentName:"a"},"BBjGridExWidget::tabToPreviousCell")),". "),(0,l.kt)("h2",{id:"editing-api"},"Editing API"),(0,l.kt)("p",null,"The grid has the following API methods for editing:"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},(0,l.kt)("strong",{parentName:"th"},"Event")),(0,l.kt)("th",{parentName:"tr",align:null},(0,l.kt)("strong",{parentName:"th"},"Description")))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("a",{parentName:"td",href:"https://bbj-plugins.github.io/BBjGridExWidget/javadoc/BBjGridExWidget/BBjGridExWidget.html#setStartCellEditing"},(0,l.kt)("inlineCode",{parentName:"a"},"BBjGridExWidget::setStartCellEditing"))),(0,l.kt)("td",{parentName:"tr",align:null},"Start editing the provided cell.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("a",{parentName:"td",href:"https://bbj-plugins.github.io/BBjGridExWidget/javadoc/BBjGridExWidget/BBjGridExWidget.html#stopEditing"},(0,l.kt)("inlineCode",{parentName:"a"},"BBjGridExWidget::stopEditing"))),(0,l.kt)("td",{parentName:"tr",align:null},"If a cell is editing, it stops the editing. Pass ",(0,l.kt)("inlineCode",{parentName:"td"},"true")," if you want to cancel the editing (i.e. don't accept changes).")))),(0,l.kt)("p",null,"The example below illustrates different parts of the editing API"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bbj",metastring:"showLineNumbers",showLineNumbers:!0},'use ::BBjGridExWidget/BBjGridExWidget.bbj::BBjGridExWidget\nuse com.basiscomponents.db.ResultSet\nuse com.basiscomponents.db.DataRow\nuse java.sql.Types\n\nwnd! = BBjAPI().openSysGui("X0").addWindow(10, 10, 800, 600, "Editing")\nwnd!.setCallback(BBjAPI.ON_CLOSE,"byebye")\n\nbtn! = wnd!.addButton(101, 10, 10, 100, 30, "Edit(1)")\nbtn!.setCallback(btn!.ON_BUTTON_PUSH, "handleEdit")\n\nbtn! = wnd!.addButton(102, 120, 10, 120, 30, "Edit(1, New)")\nbtn!.setCallback(btn!.ON_BUTTON_PUSH, "handleEditWidthNewValue")\n\nbtn! = wnd!.addButton(103, 250, 10, 140, 30, "Edit(0, New, Bottom)")\nbtn!.setCallback(btn!.ON_BUTTON_PUSH, "handleEditInPinnedBottom")\n\nbtn! = wnd!.addButton(104, 710, 10, 80, 30, "Previous")\nbtn!.setCallback(btn!.ON_BUTTON_PUSH, "handlePrevious")\nbtn!.setAttribute("theme","primary")\n\nbtn! = wnd!.addButton(105, 620, 10, 80, 30, "Next")\nbtn!.setCallback(btn!.ON_BUTTON_PUSH, "handleNext")\nbtn!.setAttribute("theme","primary")\n\nbtn! = wnd!.addButton(106, 530, 10, 80, 30, "Stop")\nbtn!.setCallback(btn!.ON_BUTTON_PUSH, "handleStop")\nbtn!.setAttribute("theme","danger")\n\ngosub main\nprocess_events\n\nmain:\n  declare ResultSet data!\n  declare ResultSet pinnedData!\n  declare BBjGridExWidget grid!\n\n  data! = new ResultSet()\n  for i=1 to 4\n      dr! = new DataRow()\n      dr!.setFieldValue("ID"      , Types.VARCHAR , "ID-" + str(i))\n      dr!.setFieldValue("DATE"    , Types.DATE    , "1979-08-03")\n      dr!.setFieldValue("DOUBLE"  , Types.DOUBLE  , rnd(5000))\n      data!.addItem(dr!)\n  next\n\n  pinnedData! = new ResultSet()\n  pinnedData!.add(dr!.clone())\n\n  grid! = new BBjGridExWidget(wnd!, 100, 0, 50, 800, 550)\n  grid!.getOptions().setEditable(1)\n  grid!.setFitToGrid()\n  grid!.setData(data!, "ID")\n  grid!.setPinnedBottomRows(pinnedData!)\nreturn\n\nhandleEdit:\n  gosub handleStop\n  grid!.focus(1, "ID")\n  grid!.setStartCellEditing(1,"ID")\nreturn\n\nhandleEditWidthNewValue:\n  gosub handleStop\n  grid!.focus(1, "ID")\n  grid!.setStartCellEditing(1,"ID", "New")\nreturn\n\nhandleEditInPinnedBottom:\n  gosub handleStop\n  grid!.focus(0, "ID", grid!.GRID_FLOATING_BOTTOM())\n  grid!.setStartCellEditing(0, "ID", -1 , "New", grid!.GRID_FLOATING_BOTTOM())\nreturn\n\nhandleStop:\n  grid!.stopEditing()\nreturn\n\nhandleNext:\n  grid!.tabToNextCell()\nreturn\n\nhandlePrevious:\n  grid!.tabToPreviousCell()\nreturn\n\nbyebye:\nbye\n')),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"BBjGridExWidget - Editing API",src:n(4202).Z,width:"802",height:"632"})),(0,l.kt)("h2",{id:"enter-key-navigation"},"Enter Key Navigation"),(0,l.kt)("p",null,"By default pressing ",(0,l.kt)("kbd",null,"Enter")," will start editing on a cell, or stop editing on an editing cell. It will not navigate to the cell below."),(0,l.kt)("p",null,"To allow consistency with Excel the grid has the following options:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"EnterMovesDown"),": Set to true to have Enter key move focus to the cell below if not editing. The default is Enter key starts editing the currently focused cell."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"EnterMovesDownAfterEdit"),": Set to true to have ",(0,l.kt)("kbd",null,"Enter")," key move focus to the cell below after ",(0,l.kt)("kbd",null,"Enter")," is pressed while editing. The default is editing will stop and focus will remain on the editing cell.")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bbj"},"grid!.getOptions().setEnterMovesDown(1)\ngrid!.getOptions().setEnterMovesDownAfterEdit(1)\n")),(0,l.kt)("h2",{id:"single-click-editing"},"Single-Click Editing"),(0,l.kt)("p",null,"The default is for the grid to enter editing when you Double-Click on a cell. To change the default so that a single-click starts editing, set the option ",(0,l.kt)("inlineCode",{parentName:"p"},"SingleClickEdit = true"),". This is useful when you want a cell to enter edit mode as soon as you click on it, similar to the experience you get when inside Excel."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bbj"},"grid!.getOptions().setSingleClickEdit(1)\n")),(0,l.kt)("h2",{id:"no-click-editing"},"No-Click Editing"),(0,l.kt)("p",null,"It is possible to configure the grid so neither Single-Click or Double-Click starts editing. To do this set the property ",(0,l.kt)("inlineCode",{parentName:"p"},"SuppressClickEdit=true"),". This is useful when you want to start the editing in another way."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bbj"},"grid!.getOptions().setSuppressClickEdit(1)\n")),(0,l.kt)("h2",{id:"stop-editing-when-grid-loses-focus"},"Stop Editing When Grid Loses Focus"),(0,l.kt)("p",null,"By default, the grid will not stop editing the currently editing cell when the cell loses focus, unless another cell is clicked on. This means clicking on the grid header, or another part of your application, will not stop editing. This can be bad if, for example, you have a save button, and you need the grid to stop editing before you execute your save function (e.g. you want to make sure the edit is saved into the grid's state)."),(0,l.kt)("p",null,"If you want the grid to stop editing when focus leaves the cell or the grid, set the grid option ",(0,l.kt)("inlineCode",{parentName:"p"},"StopEditingWhenGridLosesFocus=true"),"."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bbj"},"grid!.getOptions().setStopEditingWhenGridLosesFocus(1)\n")))}p.isMDXComponent=!0},4202:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/editing-api-9624463c29e7db7edf4798208eed95c1.png"}}]);