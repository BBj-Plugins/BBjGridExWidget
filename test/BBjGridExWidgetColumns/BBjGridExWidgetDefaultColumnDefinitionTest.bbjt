rem /**
rem  * This file is part of the BBjGridExWidget plugin.
rem  * (c) Basis Europe <eu@basis.com>
rem  *
rem  * For the full copyright and license information, please view the LICENSE
rem  * file that was distributed with this source code.
rem  */

use ::BBjGridExWidget/BBjGridExWidgetColumns.bbj::BBjGridExWidgetDefaultColumnDefinition

rem Numbers Components
rem =======================
use ::BBjGridExWidget/BBjGridExWidgetFilters.bbj::BBjGridExWidgetFilterNumber
use ::BBjGridExWidget/BBjGridExWidgetExpressions.bbj::BBjGridExWidgetExpressionNumbersFormatter
use ::BBjGridExWidget/BBjGridExWidgetCellEditors.bbj::BBjGridExWidgetCellEditorBasicNumber

rem Text Components
rem =======================
use ::BBjGridExWidget/BBjGridExWidgetFilters.bbj::BBjGridExWidgetFilterText
use ::BBjGridExWidget/BBjGridExWidgetExpressions.bbj::BBjGridExWidgetExpressionStringsFormatter
use ::BBjGridExWidget/BBjGridExWidgetCellEditors.bbj::BBjGridExWidgetCellEditorBasicText
use ::BBjGridExWidget/BBjGridExWidgetCellEditors.bbj::BBjGridExWidgetCellEditorLargeText

rem Date Components
rem =======================
use ::BBjGridExWidget/BBjGridExWidgetFilters.bbj::BBjGridExWidgetFilterBasicDate
use ::BBjGridExWidget/BBjGridExWidgetExpressions.bbj::BBjGridExWidgetExpressionDateTimesFormatter
use ::BBjGridExWidget/BBjGridExWidgetCellEditors.bbj::BBjGridExWidgetCellEditorBasicDate

rem Time Components
rem =======================
use ::BBjGridExWidget/BBjGridExWidgetFilters.bbj::BBjGridExWidgetFilterBasicTime
use ::BBjGridExWidget/BBjGridExWidgetCellEditors.bbj::BBjGridExWidgetCellEditorBasicTime

rem Timestamps Components
rem =======================
use ::BBjGridExWidget/BBjGridExWidgetFilters.bbj::BBjGridExWidgetFilterBasicTimestamp
use ::BBjGridExWidget/BBjGridExWidgetCellEditors.bbj::BBjGridExWidgetCellEditorBasicTimestamp

rem Boolean Components
rem =======================
use ::BBjGridExWidget/BBjGridExWidgetFilters.bbj::BBjGridExWidgetFilterBasicBoolean
use ::BBjGridExWidget/BBjGridExWidgetRenderers.bbj::BBjGridExWidgetRendererBoolean
use ::BBjGridExWidget/BBjGridExWidgetCellEditors.bbj::BBjGridExWidgetCellEditorBasicBoolean

use com.google.gson.JsonObject
use java.util.HashMap
use java.sql.Types

class public BBjGridExWidgetDefaultColumnDefinitionTest
    
    method private HashMap getSQLNumberTypes()
       map! = new HashMap()
       
       map!.put("Types.BIGINT" , Types.BIGINT)
       map!.put("Types.TINYINT" , Types.TINYINT)
       map!.put("Types.SMALLINT",Types.SMALLINT)
       map!.put("Types.INTEGER",Types.INTEGER)
       map!.put("Types.DECIMAL",Types.DECIMAL)
       map!.put("Types.DOUBLE",Types.DOUBLE)
       map!.put("Types.FLOAT",Types.FLOAT)
       map!.put("Types.REAL",Types.REAL)
       map!.put("Types.NUMERIC",Types.NUMERIC)
       
       methodret map!
    methodend 
    
    method private HashMap getSQLTextTypes()
       map! = new HashMap()
       
       map!.put("Types.CHAR" , Types.CHAR)
       map!.put("Types.VARCHAR" , Types.VARCHAR)
       map!.put("Types.NVARCHAR",Types.NVARCHAR)
       map!.put("Types.NCHAR",Types.NCHAR)
       map!.put("Types.LONGVARCHAR",Types.LONGVARCHAR)
       map!.put("Types.LONGNVARCHAR",Types.LONGNVARCHAR)
       map!.put("UnknowType", 9999)
       
       methodret map!
    methodend   
    
    method private HashMap getSQLDateTypes()
       map! = new HashMap()
       
       map!.put("Types.DATE" , Types.DATE)
       
       methodret map!
    methodend 
    
    method private HashMap getSQLTimeTypes()
       map! = new HashMap()
       
       map!.put("Types.TIME" , Types.TIME)
       map!.put("Types.TIME_WITH_TIMEZONE" , Types.TIME_WITH_TIMEZONE)
       
       methodret map!
    methodend 
    
    method private HashMap getSQLTimestampsTypes()
       map! = new HashMap()
       
       map!.put("Types.TIMESTAMP" , Types.TIMESTAMP)
       map!.put("Types.TIMESTAMP_WITH_TIMEZONE" , Types.TIMESTAMP_WITH_TIMEZONE)
       
       methodret map!
    methodend 
        
    method private HashMap getSQLBooleanTypes()
       map! = new HashMap()
       
       map!.put("Types.BOOLEAN" , Types.BOOLEAN)
       map!.put("Types.BIT" , Types.BIT)
       
       methodret map!
    methodend        
    
    rem @Test
    method public void testSetTypeSetNumberComponents()
        declare BBjGridExWidgetDefaultColumnDefinition def!
      
        sqlNumberTypeIt! = #getSQLNumberTypes().entrySet().iterator()
        while(sqlNumberTypeIt!.hasNext())
          next! = sqlNumberTypeIt!.next()
          
          def! = new BBjGridExWidgetDefaultColumnDefinition()
          def!.setDefaultNumbersMask("#")
          def!.setType(num(next!.getValue()))
          
          Assert.Equals("setType(" + next!.getKey() + ") configures BBjGridExWidgetFilterNumber" , def!.getFilter().equals(new BBjGridExWidgetFilterNumber()) , BBjAPI.TRUE)           
          Assert.Equals("setType(" + next!.getKey() + ") configures BBjGridExWidgetExpressionNumbersFormatter" , def!.getValueFormatterExpression().equals(new BBjGridExWidgetExpressionNumbersFormatter(def!.getDefaultNumbersMask())) , BBjAPI.TRUE)
REM           Assert.Equals("setType(" + next!.getKey() + ") configures BBjGridExWidgetCellEditorBasicNumber" , def!.getCellEditor().equals(new BBjGridExWidgetCellEditorBasicNumber(def!.getDefaultNumbersMask())) , BBjAPI.TRUE )
Assert.Equals("setType(" + next!.getKey() + ") configures BBjGridExWidgetCellEditorBasicNumber" , def!.getCellEditor().equals(new BBjGridExWidgetCellEditorBasicNumber()) , BBjAPI.TRUE )
        wend
    methodend   
    
    rem @Test
    method public void testSetTypeSetTextComponents()
        declare BBjGridExWidgetDefaultColumnDefinition def!
      
        sqlTextTypeIt! = #getSQLTextTypes().entrySet().iterator()
        while(sqlTextTypeIt!.hasNext())
          next! = sqlTextTypeIt!.next()
          value! = num(next!.getValue())
          
          def! = new BBjGridExWidgetDefaultColumnDefinition()
          def!.setDefaultStringsMask("AA-00")
          def!.setType(value!)
          
          Assert.Equals("setType(" + next!.getKey() + ") configures BBjGridExWidgetFilterText" , def!.getFilter().equals(new BBjGridExWidgetFilterText()) , BBjAPI.TRUE)           
          Assert.Equals("setType(" + next!.getKey() + ") configures BBjGridExWidgetExpressionStringsFormatter" , def!.getValueFormatterExpression().equals(new BBjGridExWidgetExpressionStringsFormatter(def!.getDefaultStringsMask())) , BBjAPI.TRUE)
          
          if((value! = Types.LONGVARCHAR) OR (value! = Types.LONGNVARCHAR))
            Assert.Equals("setType(" + next!.getKey() + ") configures BBjGridExWidgetCellEditorLargeText" , def!.getCellEditor().equals(new BBjGridExWidgetCellEditorLargeText()) , BBjAPI.TRUE )
          else
            Assert.Equals("setType(" + next!.getKey() + ") configures BBjGridExWidgetCellEditorBasicText" , def!.getCellEditor().equals(new BBjGridExWidgetCellEditorBasicText(def!.getDefaultStringsMask())) , BBjAPI.TRUE )
          fi
        wend
    methodend  

    rem @Test
    method public void testSetTypeSetDateComponents()
        declare BBjGridExWidgetDefaultColumnDefinition def!
      
        sqlDateTypeIt! = #getSQLDateTypes().entrySet().iterator()
        while(sqlDateTypeIt!.hasNext())
          next! = sqlDateTypeIt!.next()
          
          def! = new BBjGridExWidgetDefaultColumnDefinition()
          def!.setType(num(next!.getValue()))
          
          Assert.Equals("setType(" + next!.getKey() + ") configures BBjGridExWidgetFilterBasicDate" , def!.getFilter().equals(new BBjGridExWidgetFilterBasicDate(def!.getDefaultDatesMask())) , BBjAPI.TRUE)           
          Assert.Equals("setType(" + next!.getKey() + ") configures BBjGridExWidgetExpressionDateTimesFormatter" , def!.getValueFormatterExpression().equals(new BBjGridExWidgetExpressionDateTimesFormatter(def!.getDefaultDatesMask())) , BBjAPI.TRUE)
          Assert.Equals("setType(" + next!.getKey() + ") configures BBjGridExWidgetCellEditorBasicDate" , def!.getCellEditor().equals(new BBjGridExWidgetCellEditorBasicDate(def!.getDefaultDatesMask())) , BBjAPI.TRUE )
        wend
    methodend
    
    rem @Test
    method public void testSetTypeSetTimeComponents()
        declare BBjGridExWidgetDefaultColumnDefinition def!
      
        sqlTimeTypeIt! = #getSQLTimeTypes().entrySet().iterator()
        while(sqlTimeTypeIt!.hasNext())
          next! = sqlTimeTypeIt!.next()
          
          def! = new BBjGridExWidgetDefaultColumnDefinition()
          def!.setType(num(next!.getValue()))
          
          Assert.Equals("setType(" + next!.getKey() + ") configures BBjGridExWidgetFilterBasicTime" , def!.getFilter().equals(new BBjGridExWidgetFilterBasicTime(def!.getDefaultTimesMask())) , BBjAPI.TRUE)           
          Assert.Equals("setType(" + next!.getKey() + ") configures BBjGridExWidgetExpressionDateTimesFormatter" , def!.getValueFormatterExpression().equals(new BBjGridExWidgetExpressionDateTimesFormatter(def!.getDefaultTimesMask())) , BBjAPI.TRUE)
          Assert.Equals("setType(" + next!.getKey() + ") configures BBjGridExWidgetCellEditorBasicTime" , def!.getCellEditor().equals(new BBjGridExWidgetCellEditorBasicTime(def!.getDefaultTimesMask())) , BBjAPI.TRUE )
        wend
    methodend
    
    rem @Test
    method public void testSetTypeSetTimestampComponents()
        declare BBjGridExWidgetDefaultColumnDefinition def!
      
        sqlTimestampTypeIt! = #getSQLTimestampsTypes().entrySet().iterator()
        while(sqlTimestampTypeIt!.hasNext())
          next! = sqlTimestampTypeIt!.next()
          
          def! = new BBjGridExWidgetDefaultColumnDefinition()
          def!.setType(num(next!.getValue()))
          
          Assert.Equals("setType(" + next!.getKey() + ") configures BBjGridExWidgetFilterBasicTimestamp" , def!.getFilter().equals(new BBjGridExWidgetFilterBasicTimestamp(def!.getDefaultTimestampsMask())) , BBjAPI.TRUE)           
          Assert.Equals("setType(" + next!.getKey() + ") configures BBjGridExWidgetExpressionDateTimesFormatter" , def!.getValueFormatterExpression().equals(new BBjGridExWidgetExpressionDateTimesFormatter(def!.getDefaultTimestampsMask())) , BBjAPI.TRUE)
          Assert.Equals("setType(" + next!.getKey() + ") configures BBjGridExWidgetCellEditorBasicTimestamp" , def!.getCellEditor().equals(new BBjGridExWidgetCellEditorBasicTimestamp(def!.getDefaultTimestampsMask())) , BBjAPI.TRUE )
        wend
    methodend
    
    rem @Test
    method public void testSetTypeSetBooleanComponents()
        declare BBjGridExWidgetDefaultColumnDefinition def!
      
        sqlBooleanTypeIt! = #getSQLBooleanTypes().entrySet().iterator()
        while(sqlBooleanTypeIt!.hasNext())
          next! = sqlBooleanTypeIt!.next()
          
          def! = new BBjGridExWidgetDefaultColumnDefinition()
          def!.setType(num(next!.getValue()))
          
          Assert.Equals("setType(" + next!.getKey() + ") configures BBjGridExWidgetFilterBasicBoolean" , def!.getFilter().equals(new BBjGridExWidgetFilterBasicBoolean()) , BBjAPI.TRUE)           
          Assert.Equals("setType(" + next!.getKey() + ") configures BBjGridExWidgetRendererBoolean" , def!.getCellRenderer().equals(new BBjGridExWidgetRendererBoolean()) , BBjAPI.TRUE)
          Assert.Equals("setType(" + next!.getKey() + ") configures BBjGridExWidgetCellEditorBasicBoolean" , def!.getCellEditor().equals(new BBjGridExWidgetCellEditorBasicBoolean()) , BBjAPI.TRUE)
        wend
    methodend  
    
    rem @Test
    method public void testSetColumnMaskSetNumberMask()
        declare BBjGridExWidgetDefaultColumnDefinition def!
      
        sqlNumberTypeIt! = #getSQLNumberTypes().entrySet().iterator()
        while(sqlNumberTypeIt!.hasNext())
          next! = sqlNumberTypeIt!.next()
          
          def! = new BBjGridExWidgetDefaultColumnDefinition()
          def!.setType(num(next!.getValue()))
          
          newMask! = "##,###0"
          def!.setColumnMask(newMask!)
          editor! = def!.getCellEditor()
          valueFormatter! = def!.getValueFormatterExpression()

REM           Assert.Equals("setColumnMask updates cellEditor mask - column[" + next!.getKey() + "]" , editor!.getMask() , newMask!)           
          Assert.Equals("setColumnMask updates valueFormatter mask - column[" + next!.getKey() + "]" , valueFormatter!.getMask() , newMask!)
        wend
    methodend 
    
    rem @Test
    method public void testSetColumnMaskSetStringMask()
        declare BBjGridExWidgetDefaultColumnDefinition def!
      
        sqlTextTypeIt! = #getSQLTextTypes().entrySet().iterator()
        while(sqlTextTypeIt!.hasNext())
          next! = sqlTextTypeIt!.next()
          value! = num(next!.getValue())
          
          def! = new BBjGridExWidgetDefaultColumnDefinition()
          def!.setType(value!)
          
          newMask! = "AA-00"
          def!.setColumnMask(newMask!)
          editor! = def!.getCellEditor()
          valueFormatter! = def!.getValueFormatterExpression()
          
          if(!(value! = Types.LONGVARCHAR OR value! = Types.LONGNVARCHAR))
            Assert.Equals("setColumnMask updates cellEditor mask - column[" + next!.getKey() + "]" , editor!.getMask() , newMask!)
          fi
                     
          Assert.Equals("setColumnMask updates valueFormatter mask - column[" + next!.getKey() + "]" , valueFormatter!.getMask() , newMask!)
        wend
    methodend      
    
    rem @Test
    method public void testSetColumnMaskSetDateMask()
        declare BBjGridExWidgetDefaultColumnDefinition def!
      
        sqlDateTypeIt! = #getSQLDateTypes().entrySet().iterator()
        while(sqlDateTypeIt!.hasNext())
          next! = sqlDateTypeIt!.next()
          
          def! = new BBjGridExWidgetDefaultColumnDefinition()
          def!.setType(num(next!.getValue()))
          
          newMask! = "some mask" ; rem not valid mask
          def!.setColumnMask(newMask!)
          filter! = def!.getFilter()
          editor! = def!.getCellEditor()
          valueFormatter! = def!.getValueFormatterExpression()
          
          Assert.Equals("setColumnMask updates filter mask - column[" + next!.getKey() + "]" , filter!.getMask() , newMask!)
          Assert.Equals("setColumnMask updates cellEditor mask - column[" + next!.getKey() + "]" , editor!.getMask() , newMask!)           
          Assert.Equals("setColumnMask updates valueFormatter mask - column[" + next!.getKey() + "]" , valueFormatter!.getMask() , newMask!)
        wend
    methodend 
    
    rem @Test
    method public void testSetColumnMaskSetTimeMask()
        declare BBjGridExWidgetDefaultColumnDefinition def!
      
        sqlTimeTypeIt! = #getSQLTimeTypes().entrySet().iterator()
        while(sqlTimeTypeIt!.hasNext())
          next! = sqlTimeTypeIt!.next()
          
          def! = new BBjGridExWidgetDefaultColumnDefinition()
          def!.setType(num(next!.getValue()))
          
          newMask! = "some mask" ; rem not valid mask
          def!.setColumnMask(newMask!)
          filter! = def!.getFilter()
          editor! = def!.getCellEditor()
          valueFormatter! = def!.getValueFormatterExpression()
          
          Assert.Equals("setColumnMask updates filter mask - column[" + next!.getKey() + "]" , filter!.getMask() , newMask!)
          Assert.Equals("setColumnMask updates cellEditor mask - column[" + next!.getKey() + "]" , editor!.getMask() , newMask!)           
          Assert.Equals("setColumnMask updates valueFormatter mask - column[" + next!.getKey() + "]" , valueFormatter!.getMask() , newMask!)
        wend
    methodend  
    
    rem @Test
    method public void testSetColumnMaskSetTimestampMask()
        declare BBjGridExWidgetDefaultColumnDefinition def!
      
        sqlTimestampTypeIt! = #getSQLTimestampsTypes().entrySet().iterator()
        while(sqlTimestampTypeIt!.hasNext())
          next! = sqlTimestampTypeIt!.next()
          
          def! = new BBjGridExWidgetDefaultColumnDefinition()
          def!.setType(num(next!.getValue()))
          
          newMask! = "some mask" ; rem not valid mask
          def!.setColumnMask(newMask!)
          filter! = def!.getFilter()
          editor! = def!.getCellEditor()
          valueFormatter! = def!.getValueFormatterExpression()
          
          Assert.Equals("setColumnMask updates filter mask - column[" + next!.getKey() + "]" , filter!.getMask() , newMask!)
          Assert.Equals("setColumnMask updates cellEditor mask - column[" + next!.getKey() + "]" , editor!.getMask() , newMask!)           
          Assert.Equals("setColumnMask updates valueFormatter mask - column[" + next!.getKey() + "]" , valueFormatter!.getMask() , newMask!)
        wend
    methodend       
classend


